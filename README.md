# ðŸ›°ï¸ AP å¯©è¨ˆå·¥å…·ï¼ˆAP Audit LLDP Tool v16ï¼‰

[![Python](https://img.shields.io/badge/Python-3.9%2B-blue)](https://www.python.org/)
[![License: MIT](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![Status](https://img.shields.io/badge/ç‹€æ…‹-ç©©å®š-success.svg)]()

> **åŸºæ–¼ LLDP çš„ä¼æ¥­ç´š AP ç¶²è·¯å¯©è¨ˆå·¥å…·**  
> åƒ…ä»¥ **LLDP neighbor-information** åˆ¤å®š AP çš„ã€Œåœ¨ç·šã€èˆ‡ã€Œé€ŸçŽ‡ï¼ˆ100M / 1000Mï¼‰ã€ï¼›  
> ä»¥ **AC çš„ `display wlan ap all`** ä½œç‚ºæ¬Šå¨å…¨é›†ï¼›  
> `display interface brief` åªç”¨æ–¼çµ±è¨ˆã€Œæè¿°å« APã€ä½†å¯¦éš› LINK=DOWNã€çš„éºç•™ç«¯å£ã€‚

---

## ðŸ“– ç›®éŒ„

1. [é …ç›®ç°¡ä»‹](#é …ç›®ç°¡ä»‹)
2. [ä¸»è¦åŠŸèƒ½](#ä¸»è¦åŠŸèƒ½)
3. [ç³»çµ±éœ€æ±‚](#ç³»çµ±éœ€æ±‚)
4. [å®‰è£æ­¥é©Ÿ](#å®‰è£æ­¥é©Ÿ)
5. [è³‡æ–™çµæ§‹](#è³‡æ–™çµæ§‹)
6. [è¼¸å…¥æ ¼å¼èˆ‡ç¯„ä¾‹](#è¼¸å…¥æ ¼å¼èˆ‡ç¯„ä¾‹)
7. [ä½¿ç”¨èªªæ˜Ž](#ä½¿ç”¨èªªæ˜Ž)
8. [å‘½ä»¤åƒæ•¸èªªæ˜Ž](#å‘½ä»¤åƒæ•¸èªªæ˜Ž)
9. [è¼¸å‡ºçµæžœèªªæ˜Ž](#è¼¸å‡ºçµæžœèªªæ˜Ž)
10. [æ¸¬è©¦èˆ‡ç¯„ä¾‹é‹è¡Œ](#æ¸¬è©¦èˆ‡ç¯„ä¾‹é‹è¡Œ)
11. [é©—è­‰è¦å‰‡](#é©—è­‰è¦å‰‡)
12. [å¸¸è¦‹å•é¡Œ](#å¸¸è¦‹å•é¡Œ)
13. [è²¢ç»æŒ‡å—](#è²¢ç»æŒ‡å—)
14. [æŽˆæ¬Šæ¢æ¬¾](#æŽˆæ¬Šæ¢æ¬¾)
15. [ä½œè€…è³‡è¨Š](#ä½œè€…è³‡è¨Š)

---

## ðŸ§­ é …ç›®ç°¡ä»‹

`ap_audit_lldp_v16.py` æ˜¯ä¸€å€‹ç”¨æ–¼ä¼æ¥­ç¶²è·¯ç®¡ç†çš„ Python å·¥å…·ï¼Œèƒ½è‡ªå‹•åˆ†æž AC èˆ‡äº¤æ›æ©Ÿæ—¥èªŒï¼Œç”¢å‡ºåŒ…å« **åœ¨ç·š AP ç‹€æ…‹ã€é€ŸçŽ‡çµ±è¨ˆã€é›¢ç·šèˆ‡éºç•™ç«¯å£** çš„ Excel å ±è¡¨ã€‚

### æ ¸å¿ƒæµç¨‹ï¼ˆå£å¾‘ï¼‰

| æ­¥é©Ÿ | è³‡æ–™ä¾†æº | åŠŸèƒ½èªªæ˜Ž |
|------|-----------|-----------|
| 1ï¸âƒ£ | `display wlan ap all` | å¾ž AC æ“·å– AP åå–®ï¼ˆæ¬Šå¨å…¨é›†ï¼‰ |
| 2ï¸âƒ£ | `LLDP neighbor-information` | è§£æž AP åç¨±ï¼ˆSystem nameï¼‰èˆ‡ **OperMau** é€ŸçŽ‡ï¼ˆ100/1000ï¼‰â†’ æ±ºå®šã€Œåœ¨ç·š/é€ŸçŽ‡ã€ |
| 3ï¸âƒ£ | `display interface brief` | åƒ…ç”¨æ–¼æ¨™è­˜ **æè¿°å« "AP" ä¸” LINK=DOWN** çš„ç«¯å£ï¼ˆéºç•™ï¼‰ |
| 4ï¸âƒ£ | AC Ã— LLDP æ¯”å° | AC æœ‰ä½† LLDP ç„¡ â†’ Offline |
| 5ï¸âƒ£ | åŒ¯å‡ºå ±è¡¨ | ç”Ÿæˆå¤šå·¥ä½œè¡¨ Excel çµæžœï¼ˆå«æ ¡é©—ï¼‰ |

---

## âš™ï¸ ä¸»è¦åŠŸèƒ½

- âœ… è‡ªå‹•è§£æžå¤šå°äº¤æ›æ©Ÿ LLDPï¼ˆæ”¯æ´ H3C/Cisco/Huawei ç­‰å¸¸è¦‹æ ¼å¼ï¼‰  
- âœ… åŒ¯ç¸½ **ç™¾å…† / åƒå…†** åœ¨ç·š AP æ¸…å–®  
- âœ… ç²¾æº–æ¨™è¨» **é›¢ç·š AP**ï¼ˆAC æœ‰ã€LLDP ç„¡ï¼‰èˆ‡ **éºç•™ç«¯å£**ï¼ˆdesc ä¸­å« AP ä¸” LINK=DOWNï¼‰  
- âœ… ç”¢å‡º **å¤šå·¥ä½œè¡¨ Excel å ±è¡¨**ï¼ˆUTF-8ï¼‰  
- âœ… å…§å»º **å®Œæ•´æ€§æ ¡é©—**ï¼ˆåœ¨ç·š = 1000M + 100Mï¼‰

---

## ðŸ’» ç³»çµ±éœ€æ±‚

| é …ç›® | æœ€ä½Žéœ€æ±‚ |
|------|-----------|
| ä½œæ¥­ç³»çµ± | Windows / Linux / macOS |
| Python ç‰ˆæœ¬ | â‰¥ 3.9 |
| ä¾è³´å¥—ä»¶ | pandas, xlsxwriter |

å®‰è£ä¾è³´ï¼š
```bash
pip install -r requirements.txt
# æˆ–
pip install pandas xlsxwriter
```

---

## ðŸ“‚ è³‡æ–™çµæ§‹

å»ºè­°çš„å°ˆæ¡ˆçµæ§‹ï¼š
```
AP-Audit-LLDP/
â”œâ”€â”€ ap_audit_lldp_v16.py          # ä¸»ç¨‹å¼
â”œâ”€â”€ README.md                     # æœ¬æ–‡ä»¶
â”œâ”€â”€ requirements.txt              # ä¾è³´
â”œâ”€â”€ LICENSE                       # æŽˆæ¬Š
â”œâ”€â”€ examples/
â”‚   â”œâ”€â”€ sample_ac_log.log         # AC æ—¥èªŒç¯„ä¾‹
â”‚   â””â”€â”€ sample_switch_log.log     # äº¤æ›æ©Ÿæ—¥èªŒï¼ˆLLDP + briefï¼‰ç¯„ä¾‹
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ ac_logs/                  # ä½ çš„ AC æ—¥èªŒ
â”‚   â””â”€â”€ switch_logs/              # ä½ çš„äº¤æ›æ©Ÿæ—¥èªŒ
â””â”€â”€ output/
    â””â”€â”€ AP_Statistics_v16_LLDP.xlsx
```

---

## ðŸ“¥ è¼¸å…¥æ ¼å¼èˆ‡ç¯„ä¾‹

### 1) ACï¼š`display wlan ap all`
- æ¯è¡ŒåŒ…å«ä¸€å€‹ AP åç¨±ï¼Œ**æ…£ä¾‹å½¢å¦‚**ï¼š`xxx_apN`
- ä¾‹ï¼š
```
sec_101_ap1                    2     R/M   WA5320i         219801A1BX8196E0010W
sec_102_ap1                    3     R/M   WA5320i         219801A1BX8196E00112
...
```

### 2) äº¤æ›æ©Ÿï¼š`LLDP neighbor-information`
- é—œéµæ¬„ä½ï¼š`System name`ï¼ˆAP åç¨±ï¼‰ã€`OperMau : speed(100|1000)`  
- ä¾‹ï¼š
```
LLDP neighbor-information of port 3[GigabitEthernet1/0/3]:
  System name : n_1f_ap3
  OperMau     : speed(1000)/duplex(Full)
```
â†’ ä»£è¡¨ AP **n_1f_ap3** åœ¨ç·šï¼Œé€ŸçŽ‡ **1G å…¨é›™å·¥**ã€‚

### 3) äº¤æ›æ©Ÿï¼š`display interface brief`ï¼ˆåªç”¨æ–¼éºç•™ç«¯å£ï¼‰
- ç”¨ä¾†æ‰¾ **æè¿°å« "AP" ä¸” LINK=DOWN** çš„ç«¯å£ï¼š
```
GE1/0/22  DOWN  1G(a)  F(a)  A  1322  sec_402_ap1 downlink
```

---

## ðŸš€ ä½¿ç”¨èªªæ˜Ž

```bash
python ap_audit_lldp_v16.py \
  --ac-logs ./data/ac_logs \
  --lldp-logs ./data/switch_logs \
  --out ./output/AP_Statistics_v16_LLDP.xlsx
```

> å¯åŒæ™‚æŒ‡å®šå¤šå€‹ `--lldp-logs` ç›®éŒ„ï¼Œå·¥å…·æœƒè‡ªå‹•å½™æ•´ã€‚

---

## âš™ï¸ å‘½ä»¤åƒæ•¸èªªæ˜Ž

| åƒæ•¸ | èªªæ˜Ž | ç¯„ä¾‹ |
|------|------|------|
| `--ac-logs` | AC æ—¥èªŒæ‰€åœ¨è³‡æ–™å¤¾ | `./data/ac_logs` |
| `--lldp-logs` | äº¤æ›æ©Ÿæ—¥èªŒè³‡æ–™å¤¾ï¼ˆå¯å¤šå€‹ï¼‰ | `./data/switch_logs ./data/CRT_logs` |
| `--out` | Excel åŒ¯å‡ºè·¯å¾‘èˆ‡æª”å | `./output/AP_Statistics_v16_LLDP.xlsx` |

---

## ðŸ“Š è¼¸å‡ºçµæžœèªªæ˜Ž

åŸ·è¡Œå®Œæˆå¾Œæœƒç”Ÿæˆä¸€ä»½ Excelï¼ŒåŒ…å«ä»¥ä¸‹å·¥ä½œè¡¨ï¼š

| å·¥ä½œè¡¨ | èªªæ˜Ž | ä¸»è¦æ¬„ä½ |
|--------|------|----------|
| **çµ±è¨ˆæ‘˜è¦_LLDPå£å¾‘** | ç¸½è¦½çµ±è¨ˆèˆ‡æ ¡é©— | é …ç›®ã€æ•¸å€¼ |
| **åœ¨ç·šAP_LLDP** | æ‰€æœ‰åœ¨ç·š AP | ap_nameã€ACæŽ§åˆ¶å™¨ã€switch_logã€interfaceã€uplink_speedã€AC_log |
| **åœ¨ç·šAP_100M_LLDP** | åœ¨ç·šä¸”é€ŸçŽ‡ç‚º 100M çš„ AP | åŒä¸Š |
| **åœ¨ç·šAP_1000M_LLDP** | åœ¨ç·šä¸”é€ŸçŽ‡ç‚º 1G çš„ AP | åŒä¸Š |
| **Offline_AP(ACæœ‰LLDPç„¡)** | AC æœ‰ä½† LLDP ç„¡çš„ AP | ap_nameã€ACæŽ§åˆ¶å™¨ã€AC_log |
| **éºç•™AP_æè¿°å«APä½†DOWN** | æè¿°å« "AP" ä¸” LINK=DOWN çš„ç«¯å£ | switch_logã€ifaceã€linkã€pvidã€desc |

### æ ¡é©—ï¼ˆè‡ªå‹•ï¼‰
- åœ¨ç·š = åœ¨ç·š_100M + åœ¨ç·š_1000M âœ…  
- Offline = AC ç¸½æ•¸ âˆ’ åœ¨ç·š âœ…

---

## ðŸ§ª æ¸¬è©¦èˆ‡ç¯„ä¾‹é‹è¡Œ

### 1) æº–å‚™æ¸¬è©¦è³‡æ–™
```
examples/
â”œâ”€â”€ sample_ac_log.log
â””â”€â”€ sample_switch_log.log
```

### 2) åŸ·è¡Œ
```bash
python ap_audit_lldp_v16.py \
  --ac-logs ./examples \
  --lldp-logs ./examples \
  --out ./output/demo.xlsx
```

### 3) çµ‚ç«¯è¼¸å‡ºç¯„ä¾‹
```
é–‹å§‹è§£æž AC æ—¥èªŒ...
å·²è®€å– AP æ•¸é‡ï¼š176
è§£æž LLDP é„°å±…è³‡è¨Šä¸­...
åŒ¹é…åˆ°åœ¨ç·š APï¼š174
é›¢ç·š AP æ•¸é‡ï¼š2
å ±è¡¨è¼¸å‡ºå®Œæˆï¼š ./output/demo.xlsx
```

### 4) é©—è­‰
- æ‰“é–‹ `demo.xlsx`ï¼Œåœ¨ `çµ±è¨ˆæ‘˜è¦_LLDPå£å¾‘` ä¸­ç¢ºèªæ ¡é©—ç‚º âœ…ï¼›
- åœ¨ç·š AP å‡æœ‰ `uplink_speed`ï¼ˆ100M/1Gï¼‰ï¼›
- Offline æ¸…å–®èˆ‡ AC æ¸…å–®ä¸€è‡´ã€‚

---

## âœ… é©—è­‰è¦å‰‡

| é …ç›® | è¦å‰‡ |
|------|------|
| **é€ŸçŽ‡ä¾†æº** | åƒ…ä¾†è‡ª LLDP `OperMau`ï¼ˆ`speed(100)`â†’100Mï¼›`speed(1000)`â†’1Gï¼‰ |
| **åœ¨ç·š AP** | å‡ºç¾åœ¨ LLDP é„°å±…è³‡è¨Šä¸­ |
| **é›¢ç·š AP** | å‡ºç¾åœ¨ AC æ¸…å–®ä½† **æœª** å‡ºç¾åœ¨ LLDP |
| **éºç•™ç«¯å£** | `display interface brief`ï¼šæè¿°å« "AP" ä¸” LINK=DOWN |
| **å®Œæ•´æ€§** | åœ¨ç·š = 100M + 1000M âœ… |

---

## ðŸ” å¸¸è¦‹å•é¡Œ

| å•é¡Œ | å¯èƒ½åŽŸå›  | è™•ç†æ–¹å¼ |
|------|----------|----------|
| Excel ç‚ºç©º | AC æ—¥èªŒæœªå« `_ap` æ¨™è­˜ | æª¢æŸ¥ AC log æ ¼å¼æˆ–æŽ¡é›†æŒ‡ä»¤ |
| åœ¨ç·šæ•¸éŽå°‘ | äº¤æ›æ©Ÿæœªå•Ÿç”¨ LLDP / æ—¥èªŒä¸å®Œæ•´ | å•Ÿç”¨ LLDPï¼Œä½¿ç”¨ **verbose** æ¨¡å¼å°Žå‡º |
| ç„¡é€ŸçŽ‡ | LLDP ç¼ºå°‘ `OperMau` æ¬„ä½ | æ”¹ç”¨ `display lldp neighbor-information verbose` |
| ä¸­æ–‡äº‚ç¢¼ | Windows é è¨­ç·¨ç¢¼å°Žè‡´ | åŸ·è¡Œ `chcp 65001`ï¼Œæˆ–ç¢ºä¿æª”æ¡ˆç‚º UTF-8 |

---

## ðŸ¤ è²¢ç»æŒ‡å—

1. Fork æœ¬å€‰åº«  
2. å»ºç«‹æ–°åˆ†æ”¯ï¼š`git checkout -b feature/your-feature`  
3. æäº¤ä¿®æ”¹ï¼š`git commit -m "Add new feature"`  
4. æŽ¨é€ï¼š`git push origin feature/your-feature`  
5. ç™¼èµ· Pull Request

---

## ðŸ“œ æŽˆæ¬Šæ¢æ¬¾

æœ¬å°ˆæ¡ˆæŽ¡ç”¨ [MIT License](LICENSE)ã€‚

---

## ðŸ‘¤ ä½œè€…è³‡è¨Š

- ä½œè€…ï¼šæœ±æŒ¯å®‡ï¼ˆZhu Zhenyuï¼‰  
- å–®ä½ï¼šæ¾³é–€è–ä¿ç¥¿å­¸æ ¡ï¼ˆSt. Paul School, Macauï¼‰è³‡è¨Šéƒ¨  
- ç‰ˆæœ¬ï¼šv16  
- è¯çµ¡ï¼šè«‹æ–¼ GitHub Issues å»ºç«‹å•é¡Œå–®

---

### ðŸ§­ LLDP è³‡æ–™ç¯„ä¾‹ï¼ˆè§£æžæ¨£æœ¬ï¼‰
```
LLDP neighbor-information of port 3[GigabitEthernet1/0/3]:
  System name : n_1f_ap3
  OperMau     : speed(1000)/duplex(Full)
```
â†’ åˆ¤å®šï¼šAP **n_1f_ap3** åœ¨ç·šã€é€ŸçŽ‡ **1G å…¨é›™å·¥**ã€‚

> å»ºè­°åœ¨å°Žå‡ºå‰æ–¼äº¤æ›æ©ŸåŸ·è¡Œï¼š  
> `display lldp neighbor-information verbose` èˆ‡ `display interface brief`ã€‚
